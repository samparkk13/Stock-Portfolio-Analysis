<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Portfolio Chatbot</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Portfolio Input Modal -->
    <div class="portfolio-modal" id="portfolioModal">
        <div class="portfolio-modal-content">
            <div class="portfolio-modal-header">
                <h2>ðŸ“Š Welcome! Set Up Your Portfolio</h2>
                <p>Enter your stock holdings to get personalized analysis</p>
            </div>
            
            <div class="portfolio-input-section">
                <div class="portfolio-holdings" id="portfolioHoldings">
                    <!-- Holdings will be added here -->
                </div>
                
                <div class="add-holding-form">
                    <input type="text" id="tickerInput" placeholder="Ticker (e.g., AAPL)" class="holding-input">
                    <input type="number" id="sharesInput" placeholder="Shares" class="holding-input" min="1">
                    <button id="addHoldingBtn" class="add-btn">+ Add</button>
                </div>
            </div>

            <div class="portfolio-examples">
                <p class="examples-label">Quick examples:</p>
                <button class="example-btn" data-example="conservative">Conservative Portfolio</button>
                <button class="example-btn" data-example="tech">Tech-Heavy Portfolio</button>
                <button class="example-btn" data-example="diversified">Diversified Portfolio</button>
            </div>
            
            <div class="portfolio-modal-actions">
                <button id="skipPortfolioBtn" class="skip-btn">Skip for now</button>
                <button id="savePortfolioBtn" class="save-btn">Save Portfolio & Continue</button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Backend Log Panel -->
        <div class="log-panel" id="logPanel">
            <div class="log-header">
                <div class="log-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
                        <polyline points="14 2 14 8 20 8"/>
                        <line x1="16" y1="13" x2="8" y2="13"/>
                        <line x1="16" y1="17" x2="8" y2="17"/>
                        <line x1="10" y1="9" x2="8" y2="9"/>
                    </svg>
                    <span>Backend Log</span>
                </div>
                <button id="clearLogButton" class="clear-log-button" title="Clear log">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 6h18"/>
                        <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/>
                        <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
                    </svg>
                </button>
            </div>
            <div class="log-content" id="logContent">
                <div class="log-empty">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="16" x2="12" y2="12"/>
                        <line x1="12" y1="8" x2="12.01" y2="8"/>
                    </svg>
                    <p>No tool calls yet</p>
                </div>
            </div>
        </div>

        <div class="chat-container">
            <!-- Header -->
            <div class="chat-header">
                <div class="header-content">
                    <div class="bot-avatar">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 8V4H8"/>
                            <rect width="16" height="12" x="4" y="8" rx="2"/>
                            <path d="M2 14h2"/>
                            <path d="M20 14h2"/>
                            <path d="M15 13v2"/>
                            <path d="M9 13v2"/>
                        </svg>
                    </div>
                    <div class="header-info">
                        <h1>Stock Portfolio Assistant</h1>
                        <p class="status">
                            <span class="status-dot"></span>
                            <span id="portfolioStatus">No portfolio set</span>
                        </p>
                    </div>
                </div>
                <button id="editPortfolioBtn" class="edit-portfolio-btn" title="Edit portfolio">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                    </svg>
                </button>
            </div>

            <!-- Chat Messages Area -->
            <div class="chat-messages" id="chatMessages">
                <div class="message bot-message">
                    <div class="message-avatar">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 8V4H8"/>
                            <rect width="16" height="12" x="4" y="8" rx="2"/>
                            <path d="M2 14h2"/>
                            <path d="M20 14h2"/>
                            <path d="M15 13v2"/>
                            <path d="M9 13v2"/>
                        </svg>
                    </div>
                    <div class="message-content">
                        <p>Hello! I'm your Stock Portfolio Assistant. I can help you analyze stocks, check prices, and manage your portfolio.</p>
                        <p style="margin-top: 8px;">ðŸ’¡ <strong>Tip:</strong> Set up your portfolio to get personalized analysis!</p>
                    </div>
                </div>
            </div>

            <!-- Chat Input Area -->
            <div class="chat-input-container">
                <div class="chat-input-wrapper">
                    <textarea 
                        id="chatInput" 
                        class="chat-input" 
                        placeholder="Ask about stocks, prices, portfolio analysis..."
                        rows="1"
                    ></textarea>
                    <button id="sendButton" class="send-button" title="Send message">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m22 2-7 20-4-9-9-4Z"/>
                            <path d="M22 2 11 13"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/chat.js') }}"></script>
</body>
</html>